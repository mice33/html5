define(["libs"],function(){"use strict";var cLog={},_parse=function(obj){return JSON.stringify?JSON.stringify(obj):eval("("+obj+")")},_getDateTime=function(){var a=new Date,b="";return b+=a.getMonth()+1,b+="/",b+=a.getDate(),b+=" ",b+=a.getHours(),b+=":",b+=a.getMinutes(),b+=":",b+=a.getSeconds()},_isExistServerLog=function(){var a=!1,b=window.localStorage.getItem("H5_CFG");return b&&(a=JSON.parse(b).value.serverLog),!!a};return cLog.checkServerLog=_isExistServerLog(window),cLog.serverLog=function(a,b,c){if(this.checkServerLog){var d={url:a,rspCode:c?"200":"404",req:b,rsp:c,dt:_getDateTime()};this.pushLog("SERVER_LOG",d)}},cLog.errorLog=function(a,b,c){var d=cLog.buildErrorObj(a,b,c);return cLog.pushLog("ERROR_LOG",d),!1},cLog.urlLog=function(a){if(!(a.indexOf("monitor")>-1)){var b={url:a,dt:_getDateTime()};cLog.pushLog("URL_LOG",b)}},cLog.restlog=function(a,b,c){if(this.serverLog){var d={url:a,rspCode:c?"200":"404",req:b,rsp:c,dt:_getDateTime()};this.pushLog("SERVER_LOG",d)}},cLog.appLog=function(a,b){var c=localStorage.getItem("APP_LOG"),d=c?JSON.parse(c):{};d[a]={data:b,dt:_getDateTime()};var e=_parse(d);localStorage.setItem("APP_LOG",e)},cLog.applog=function(a,b){this.appLog(a,b)},cLog.buildErrorObj=function(a,b,c){var d="string"==typeof b?b.substr(b.lastIndexOf("/")+1):"";return{msg:a,file:d,line:c,fullPath:b,dt:_getDateTime(),url:window.location.href,restful:{url:"",request:"",response:""}}},cLog.sendLog=function(a,b,c){$.post("http://"+this.logServerUrl+"/"+a,b,function(a){0,"function"==typeof c&&c()})},cLog.pushLog=function(a,b){var c=localStorage.getItem(a),d=[],e=c?JSON.parse(c):[];e.length>0&&e.splice(50),e.unshift(b),d=_parse(e),localStorage.setItem(a,d)},window.onerror=function(a,b,c){cLog.errorLog(a,b,c)},window.onload=function(){cLog.urlLog(window.location.href)},window.onhashchange=function(){cLog.urlLog(window.location.href)},cLog});