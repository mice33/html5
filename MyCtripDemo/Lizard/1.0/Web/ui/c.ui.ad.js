!function(){var a={t:600,hasApp:!1,key:"HAS_CTRIP_APP",appProtocol:"ctrip://wireless",openApp:function(b,c,d){var e=a.getAppData(),f=Date.now();if(e&&""!=e)return e.hasApp?"function"==typeof b?b()&&d&&d.length>0&&(window.location=d):d&&d.length>0&&(window.location=d):"function"==typeof c&&c(),"";if(!d||d.length<=0)return void("function"==typeof c&&c());var g=navigator.userAgent?navigator.userAgent.toLocaleLowerCase():"",h=-1!=g.indexOf("android",0)||-1!=g.indexOf("adr",0)?1:0,i=h&&-1!=g.indexOf("chrome",0),j=$('<iframe style="display: none;"></iframe>');if(j.attr("src",d),$("body").append(j),i){if(!d||d.length<=0)return;window.location="intent://m.ctrip.com/#Intent;scheme=ctrip;package=携程旅行;end"}setTimeout(function(){a.testApp(f)},a.t),a.setTestResult(b,c)},testApp:function(b){var c=Date.now();a.hasApp=c-b<a.t+200?!1:!0},setTestResult:function(b,c){setTimeout(function(){a.hasApp?"function"==typeof b&&b():"function"==typeof c&&c();var d=new Date;d.setHours(d.getHours()+1);var e={value:{hasApp:a.hasApp},timeout:d.toUTCString()};window.localStorage.setItem(a.key,JSON.stringify(e)),window.hasApp=a.hasApp},a.t+1e3)},getAppData:function(){return""}};window.AppUtility=a}();var adOptions=adOptions||{};adOptions.__propertys__=function(){},adOptions.initialize=function($super,a){this.data=a||{},this.storeKey="APP_DOWNLOAD",$super(a)},adOptions.update=function(a){this.isInFooter&&(this.remove(),this.isCreate=!1),this.rootBox=a.rootBox,this.root||(this.root=this.rootBox),this.isInFooter=!!this.rootBox.hasClass("js_in_Footer"),this.addEvent&&(this.removeEvent("onShow"),this.addEvent("onShow",this.onShow))},adOptions.createHtml=function(){var a=(adOptions.getUrlParam("sourceid"),adOptions.getUrlParam("sales"),adOptions.getUrlParam("allianceid")),b=adOptions.getUrlParam("sid"),c=this.isInFooter?"":"fix_bottom",d="/market/download.aspx?from=H5",e=adOptions._get("SALES_OBJECT"),f=adOptions._get("UNION"),g=adOptions._getCookie("UNION"),h="";if(a&&a.length>0&&b&&b.length>0&&(h="display:none;"),(f||g)&&(h="display:none;"),e&&e.sid&&+e.sid>0&&((!e.appurl||e.appurl.length<=0)&&(h="display:none;"),d=e.appurl?e.appurl:"/market/download.aspx?from="+e.sid),0==this.checkDeviceSupport()&&(h="display:none;"),h.length>0)return $("footer")&&$("footer").removeClass("pb85"),$('div[data-role="footer"]')&&$('div[data-role="footer"]').removeClass("pb85"),$("#panel-box")&&$("#panel-box").removeClass("pb85"),$(".f_list")&&$(".f_list").removeClass("pb85"),adOptions.saveExpire(1),"";var i=this.setAppUrl();return['<div data-appurl="'+i+'" id="dl_app" style="'+h+'" class="',c,'"> <div id="icon_text" class="txt_middle"><img src="http://res.m.ctrip.com/html5/content/images/icon_text_s6.png"/></div>',' <a href="'+d+'" id="app_link" class="txt_middle __appaddress__"><img src="http://res.m.ctrip.com/html5/content/images/icon_open_s6.png"/></a>','<div id="close_icon"></div>',"</div>"].join("")},adOptions.getUrlParam=function(a){var b=document.location.href||"",c=new RegExp("(\\?|&)"+a+"=([^&]+)(&|$)","i"),d=b.match(c);return d?d[2]:""},adOptions.setAppUrl=function(){var a=adOptions._get("SALES_OBJECT"),b=AppUtility.appProtocol,c=null,d=null,e=null,f=null,g=null,h=null,i=null,j=null,k=null,l=null,m=null,n=null,o=null,p=$("#page_id").val(),q=new RegExp("-","g"),r=new RegExp("/","g");if(p&&+p>0){if((212092==+p||212093==+p||212094==+p||210090==+p)&&(c=212092==+p?"hotel_inquire":212093==+p||210090==+p?"hotel_inland_list":212094==+p?"InlandHotel":"",d=window.localStorage?window.localStorage.getItem("HOTELSEARCHINFO"):null)){if(d=JSON.parse(d),212092==+p){if(d.data){if(e=d.data.CheckInDate.replace(q,""),f=d.data.CheckOutDate.replace(q,""),g=d.data.CheckInCityID,h=d.data.DistrictId?+d.data.DistrictId<=0?"":d.data.DistrictId:"",i=d.data.BrandId||"",j=d.data.BrandName||"",d.data.Qparams&&d.data.Qparams.length>0)for(var s in d.data.Qparams){var t=d.data.Qparams[s];if(t&&t.itpe&&3==+t.itpe){i=t.ival||"";break}}k=0}c+="?c1="+(e||"")+"&c2="+(f||"")+"&c3="+(g||"")+"&c4="+(h||"")+"&c5="+(i||"")+"&c6="+(j||"")+"&c7="+(k||"")}if(212093==+p||210090==+p){if(d.data){if(e=d.data.CheckInDate.replace(q,""),f=d.data.CheckOutDate.replace(q,""),g=d.data.CheckInCityID,h=d.data.DistrictId?+d.data.DistrictId<=0?"":d.data.DistrictId:"",i=0,j=d.data.BrandId?+d.data.BrandId<=0?"":d.data.BrandId:"",k=d.data.BrandName||"",d.data.Qparams&&d.data.Qparams.length>0)for(var s in d.data.Qparams){var t=d.data.Qparams[s];if(t&&t.itpe&&3==+t.itpe){j=t.ival||"";break}}l=0,m=1,n="",o="",210090==+p&&(m=2,n=d.data.Latitude,o=d.data.Longitude)}c+="?c1="+(e||"")+"&c2="+(f||"")+"&c3="+(g||"")+"&c4="+(h||"")+"&c5="+(i||"")+"&c6="+(j||"")+"&c7="+(k||"")+"&c8="+(l||"")+"&c9="+(m||"")+"&c10="+(n||"")+"&c11="+(o||"")}if(212094==+p){d.data&&(e=d.data.CheckInDate.replace(q,""),f=d.data.CheckOutDate.replace(q,""),g=d.data.CheckInCityID);var u=window.localStorage?window.localStorage.getItem("HOTELDETAIL"):null;u&&(u=JSON.parse(u),u&&u.data&&(h=u.data.HotelID)),c+="?checkInDate="+(e||"")+"&checkOutDate="+(f||"")+"&cityId="+(g||"")+"&hotelId="+(h||"")}}if(212042==+p&&(c="flight_board_detail",d=window.localStorage?window.localStorage.getItem("AIRSTATE_DETAIL_PARAM"):null,d=d?JSON.parse(d):null,d&&d.data&&d.data.fNo&&d.data.fNo.length>0&&d.data.dPort&&d.data.dPort.length>0&&d.data.aPort&&d.data.aPort.length>0&&(e=d.data.fdate,f=d.data.fNo,g=d.data.dPort,h=d.data.aPort,c+="?c1="+e+"&c2="+f+"&c3="+g+"&c4="+h)),(212001==+p||214008==+p)&&(c=212001==+p?"hotel_groupon_list":214008==+p?"hotel_groupon_detail":"",212001==+p&&(d=window.localStorage?window.localStorage.getItem("TUAN_SEARCH"):null,d=d?JSON.parse(d):null,e=d&&d.value?d.value.ctyId:"2",c+="?c1="+(e||"2")),214008==+p&&(d=window.localStorage?window.localStorage.getItem("TUAN_DETAILS"):null,d=d?JSON.parse(d):null,e=d&&d.value?d.value.id:null,c+="?c1="+(e||""))),212003==+p||212004==+p||212009==+p||214019==+p||214209==+p){d=null;var v=null;window.localStorage&&(d=window.localStorage.getItem("S_FLIGHT_AirTicket")||window.localStorage.getItem("FLIGHT_SEARCH"),v=window.localStorage.getItem("S_FLIGHT_SUBJOIN")||window.localStorage.getItem("FLIGHT_SEARCH_SUBJOIN")),d=d?JSON.parse(d):null,d&&d.value&&(e=d.value.tripType,d.value._items&&d.value._items.length>0?(f=d.value._items[0].dCtyId,g=d.value._items[0].aCtyId||d.value.segments[0].aCtyId,d.value._items[0].date&&(h=d.value._items[0].date.replace(r,""))):d.value.segments&&d.value.segments.length>0&&(f=d.value.segments[0].dCtyId,g=d.value.segments[0].aCtyId,h=d.value.segments[0].dDate?d.value.segments[0].dDate.replace(r,""):""),e&&+e>1&&(i=d.value._items&&d.value._items.length>1&&d.value._items[1].date?d.value._items[1].date.replace(r,""):d.value.segments[1].dDate?d.value.segments[1].dDate.replace(r,""):""),(214019==+p||214209==+p)&&(v=null,window.localStorage&&(v=window.localStorage.getItem("S_FLIGHT_INTLAirTicket")||window.localStorage.getItem("FLTINTL_SEARCH"))),h=h?h.replace(q,""):"",i=i?i.replace(q,""):"",v=v?JSON.parse(v):null,j="",k="",l="",m="",n="",o="",v&&v.value&&(214019==+p||214209==+p?(j=1,0==+v.value.class&&(k="1"),1==+v.value.class&&(k="2"),2==+v.value.class&&(k="3"),3==+v.value.class&&(k="4"),2==+v.value.sortRule&&(2==+v.value.sortType&&(l="1"),1==+v.value.sortType&&(l="2")),1==+v.value.sortRule&&(2==+v.value.sortType&&(l="3"),1==+v.value.sortType&&(l="4")),214209==+p&&(k=l=m="")):("1"==v.value["departfilter-type"]&&("3"==v.value["departfilter-value"]&&(j="5"),"0"==v.value["departfilter-value"]&&(j="1")),"price"==v.value["depart-sorttype"]&&("asc"==v.value["depart-orderby"]&&(k="3"),"desc"==v.value["depart-orderby"]&&(k="4")),"time"==v.value["depart-sorttype"]&&("asc"==v.value["depart-orderby"]&&(k="1"),"desc"==v.value["depart-orderby"]&&(k="2")),"0"==v.value["departfilter-type"]&&(m=v.value["departfilter-value"]||"",m=m.replace("-","|"),m=m.replace(":",""),m=m.replace(":","")),"2"==v.value["departfilter-type"]&&(o=v.value["departfilter-value"]||""),212009==+p&&(j=k=l=m=o="")))),212003==+p&&(c="flight_inquire"),(212009==+p||212004==+p)&&(c=e&&+e>1?"flight_inland_tolist":"flight_inland_singlelist"),(214019==+p||214209==+p)&&(c=e&&+e>1?"flight_int_tolist":"flight_int_singlelist"),c+="?c1="+(e||"")+"&c2="+(f||"")+"&c3="+(g||"")+"&c4="+(h||"")+"&c5="+(i||"")+"&c6="+(j||"")+"&c7="+(k||"")+"&c8="+(l||"")+"&c9="+(m||"")+"&c10="+(n||"")+"&c11="+(o||"")}if((212071==+p||212072==+p)&&(c=212071==+p?"train_inquire":"train_list",d=window.localStorage?window.localStorage.getItem("TRAINSSEARCHINFO"):null,d=d?JSON.parse(d):null,d&&d.data&&(e=d.data.DepartCityId||"",f=d.data.ArriveCityId||"",g=d.data.DepartDate||"",g=g.replace(q,"")),c+="?c1="+(e||"")+"&c2="+(f||"")+"&c3="+(g||"")),214040==+p||214045==+p||214046==+p||214041==+p||214345==+p||214346==+p||214042==+p||214353==+p||214354==+p){if(e=f=g=h=i=j="",d=window.localStorage?window.localStorage.getItem("VACATIONS_PRODUCT_LIST_PARAM"):null,d=d?JSON.parse(d):null,214040==+p&&(c="vacation_home"),214045==+p){if(c="vacation_weekend_list",d&&d.value&&(e=d.value.dCtyId,d.value.qparams||d.value.qparams.length>0))for(var s in d.value.qparams){var t=d.value.qparams[s];t&&t.type&&(3==+t.type&&(f=t.val),2==+t.type&&(g=t.val),6==+t.type&&(i=t.val),7==+t.type&&(j=t.val))}c+="?cityId="+(e||"")+"&districtId="+(f||"")+"&travelDaysId="+(g||"")+"&levelId="+(h||"")+"&isSelfProudct="+(i||"")+"&isDiscount="+(j||"")}if(214046==+p&&(c="vacation_nearby_detail",e=f="",d=window.localStorage?window.localStorage.getItem("VACATIONS_PRODUCT_DETAIL_PARAM"):null,d=d?JSON.parse(d):null,d&&d.value&&(e=d.value.dCtyId||"",f=d.value.pid||""),c+="?departCityId="+(e||"")+"&productId="+(f||"")),214041==+p&&(c="vacation_group_inquire",e=f=g=h="",d=window.localStorage?window.localStorage.getItem("VACATIONS_GROUP_SEARCH_PARAM"):null,d=d?JSON.parse(d):null,d&&d.value&&(e=d.value.dCtyId,f=d.value.destKwd),c+="?departCityId="+(e||"")+"&arriveName="+(f||"")+"&travelDaysId="+(g||"")+"&levelId="+(h||"")),214345==+p){if(c="vacation_group_list",e=f=g=h=i=j=k="",d=window.localStorage?window.localStorage.getItem("VACATIONS_PRODUCT_LIST_PARAM"):null,d=d?JSON.parse(d):null,d&&d.value&&(e=d.value.dCtyId,f=d.value.destKwd,d.value.qparams||d.value.qparams.length>0))for(var s in d.value.qparams){var t=d.value.qparams[s];t&&t.type&&(3==+t.type&&(g=t.val),2==+t.type&&(h=t.val),6==+t.type&&(j=t.val),7==+t.type&&(k=t.val))}c+="?departCityId="+(e||"")+"&arriveName="+(f||"")+"&districtId="+(g||"")+"&travelDaysId="+(h||"")+"&levelId="+(i||"")+"&isSelfProduct="+(j||"")+"&isDiscount="+(k||"")}if(214346==+p&&(c="vacation_group_detail",e=f="",d=window.localStorage?window.localStorage.getItem("VACATIONS_PRODUCT_DETAIL_PARAM"):null,d=d?JSON.parse(d):null,d&&d.value&&(e=d.value.dCtyId||"",f=d.value.pid||""),c+="?departCityId="+(e||"")+"&productId="+(f||"")),214042==+p){if(c="vacation_cruises_inquire",d=window.localStorage?window.localStorage.getItem("VACATIONS_CRUISE_SEARCH_PARAM"):null,d=d?JSON.parse(d):null,e=f="",d&&d.value&&(e=d.value.dCtyId||"",d.value.qparams||d.value.qparams.length>0))for(var s in d.value.qparams){var t=d.value.qparams[s];14==+t.type&&(f=t.val)}c+="?departCityId="+(e||"")+"&routeId="+(f||"")}if(214353==+p){if(c="vacation_cruises_list",d=window.localStorage?window.localStorage.getItem("VACATIONS_PRODUCT_LIST_PARAM"):null,d=d?JSON.parse(d):null,e=f=g=h=i=j=k="",d&&d.value&&(e=d.value.dCtyId,d.value.qparams||d.value.qparams.length>0))for(var s in d.value.qparams){var t=d.value.qparams[s];t&&(14==+t.type&&(f=t.val),10==+t.type&&(g=t.val),11==+t.type&&(h=t.val),12==+t.type&&(i=t.val),6==+t.type&&(j=t.val),7==+t.type&&(k=t.val))}c+="?departCityId="+(e||"")+"&routeId="+(f||"")+"&companyId="+(g||"")+"&productFormId="+(h||"")+"&portDepartId="+(i||"")+"&isSelfProduct="+(j||"")+"&isDiscount="+(k||"")}214354==+p&&(c="vacation_cruises_detail",d=window.localStorage?window.localStorage.getItem("VACATIONS_PRODUCT_DETAIL_PARAM"):null,d=d?JSON.parse(d):null,e=f="",d&&d.value&&(e=d.value.dCtyId||"",f=d.value.pid||""),c+="?departCityId="+(e||"")+"&productId="+(f||""))}}b+=c?"/"+c:"";var w=this.getCurrentView();return w&&w.getAppUrl&&(b=AppUtility.appProtocol+w.getAppUrl()),b.indexOf("?")<=-1&&(b+="?v=2"),b+=a&&a.sid&&+a.sid>0?"&extendSourceID="+a.sid:"&extendSourceID=8888"},adOptions.onShow=function(){this.root.off("click"),this.root.find("#close_icon").on("click",$.proxy(function(){this.saveExpire(1),this.hide(),$("footer")&&$("footer").removeClass("pb85"),$("#panel-box")&&$("#panel-box").removeClass("pb85"),$('div[data-role="footer"]')&&$('div[data-role="footer"]').removeClass("pb85"),$(".f_list")&&$(".f_list").removeClass("pb85")},this));var a=this;this.root.find("#app_link").off("click").on("click",function(b){b.preventDefault();var c=$(this).attr("href"),d=a.setAppUrl(),e=($("#page_id").val(),navigator.userAgent?navigator.userAgent.toLocaleLowerCase():""),f=-1!=e.indexOf("mac",0)||-1!=navigator.userAgent.indexOf("ios",0)?1:0;return f?(window.location=d,setTimeout(function(){window.location="itms-apps://itunes.apple.com/cn/app/id379395415?mt=8"},30)):AppUtility.openApp(function(){return a.saveExpire(),!0},function(){window.location=c},d),!1}),0==this.checkDeviceSupport()&&("dl_app"==this.root.attr("id")&&this.root.hide(),$("footer")&&$("footer").removeClass("pb85"),$('div[data-role="footer"]')&&$('div[data-role="footer"]').removeClass("pb85"),$("#panel-box")&&$("#panel-box").removeClass("pb85"),$(".f_list")&&$(".f_list").removeClass("pb85"))},adOptions.checkDeviceSupport=function(){var a=navigator.userAgent?navigator.userAgent.toLocaleLowerCase():"",b=-1!=a.indexOf("mac",0)||-1!=navigator.userAgent.indexOf("ios",0)?1:0,c=-1!=a.indexOf("android",0)||-1!=a.indexOf("adr",0)?1:0;return 0==b&&0==c?!1:!0},adOptions.saveExpire=function(a){var b={isExpire:1},c=new Date;a&&(b.isClose=a),c.setDate(c.getDate()+1),this.storeKey||(this.storeKey="APP_DOWNLOAD"),this._set(this.storeKey,b,c.toUTCString())},adOptions.saveAutoDown=function(a){var b={isAutoDown:1,sid:a},c=new Date;c.setDate(c.getDate()+1),this._set("APP_AUTODOWNLOAD",b,c.toUTCString())},adOptions.appDownload=function(){var a=adOptions._get("SALES_OBJECT"),b=AppUtility.appProtocol;b+=a&&a.sid&&+a.sid>0?"?extendSourceID="+a.sid:"?extendSourceID=8888";var c=navigator.userAgent?navigator.userAgent.toLocaleLowerCase():"",d=-1!=c.indexOf("mac",0)||-1!=navigator.userAgent.indexOf("ios",0)?1:0;d?(window.location=b,setTimeout(function(){window.location="itms-apps://itunes.apple.com/cn/app/id379395415?mt=8"},30)):AppUtility.openApp(function(){return!0},function(){var b="http://m.ctrip.com/market/download.aspx?from=H5";a&&(a.appurl&&a.appurl.length>0?b=a.appurl:a.sid&&+a.sid>0&&(b="http://m.ctrip.com/market/download.aspx?from="+a.sid)),window.location.href=b},b)},adOptions.checkForceDownload=function(){},adOptions.checkAutoDownload=function(){var a=this.getUrlParam("sourceid"),b=this.getUrlParam("openapp"),c=this.getUrlParam("downapp");if(!(!a||a.length<=0||0>=+a)){var d=0,e=0,f=0,g=0,h=navigator.userAgent?navigator.userAgent.toLocaleLowerCase():"",i=-1!=h.indexOf("mac",0)||-1!=navigator.userAgent.indexOf("ios",0)?1:0,j=-1!=h.indexOf("android",0)||-1!=h.indexOf("adr",0)?1:0;c&&(i&&(2==+c||3==+c)&&(d=1),j&&(1==+c||3==+c)&&(e=1));var k=null;b&&(i&&(2==+b||3==+b?g=1:(g=0,k=null)),j&&(1==+b||3==+b?f=1:(f=0,k=null))),(f||g)&&(k=adOptions.setAppUrl());var l=adOptions._get("SALES_OBJECT"),m=adOptions.isAutoDown(a);if(i){if(k&&k.length>0&&(window.location=k),m||!d||1!=+d)return adOptions.saveExpire(0),void adOptions.saveAutoDown(a);adOptions.saveExpire(0),adOptions.saveAutoDown(a),setTimeout(function(){window.location="itms-apps://itunes.apple.com/cn/app/id379395415?mt=8"},30)}else AppUtility.openApp(function(){adOptions.saveExpire(0),adOptions.saveAutoDown(a)},function(){if(adOptions.saveExpire(0),adOptions.saveAutoDown(a),!m){var b=-1!=h.indexOf("360browser",0)||-1!=navigator.userAgent.indexOf("360",0)?1:0;if(!j||b||!navigator.connection||navigator.connection.type==navigator.connection.WIFI){var c="http://m.ctrip.com/market/download.aspx?from="+a;if(j){if(!e||1!=+e)return;c+="&App=3"}i&&(c+="&App=1"),l&&l.sid&&+l.sid>0&&+l.sid==+a&&l.appurl&&l.appurl.length>0&&(c=l.appurl),window.location.href=c}}},k)}},adOptions.create=function(){if(this.isCreate||this.isExpire()||this.status&&this.status==this.STATE_ONCREATE)$("footer")&&$("footer").removeClass("pb85"),$("#panel-box")&&$("#panel-box").removeClass("pb85"),$(".f_list")&&$(".f_list").removeClass("pb85"),$('div[data-role="footer"]')&&$('div[data-role="footer"]').removeClass("pb85");else{var a=this.createHtml();a&&a.length>0?(this.root=$(a),this.rootBox.append(this.root),this.trigger("onCreate")):($("footer")&&$("footer").removeClass("pb85"),$('div[data-role="footer"]')&&$('div[data-role="footer"]').removeClass("pb85"),$("#panel-box")&&$("#panel-box").removeClass("pb85"),$(".f_list")&&$(".f_list").removeClass("pb85")),this.isCreate=!0}if(!window.___checkAutoDownloadRun){window.___checkAutoDownloadRun=!0;var b=this;setTimeout(function(){b.checkAutoDownload()},2500)}},adOptions.isExpire=function(){var a=this._get(this.storeKey);return a&&a.isClose?!0:!1},adOptions.isAutoDown=function(){var a=this._get("APP_AUTODOWNLOAD");return a&&a.isAutoDown?!0:!1},adOptions._getCookie=function(a){var b=null;if(a){var c=new RegExp("\\b"+a+"=([^;]*)\\b"),d=c.exec(document.cookie);b=d&&unescape(d[1])}else{var e,f,g=document.cookie.split(";");for(b={},e=0,len=g.length;len>e;e++)f=g[e].split("="),b[f[0]]=unescape(f[2])}return b},adOptions.setCurrentView=function(a){this.curView=a},adOptions.getCurrentView=function(){return this.curView},adOptions._get=function(a){var b=window.localStorage.getItem(a);return b&&(b=JSON.parse(b),Date.parse(b.timeout)>=new Date)?b.value||b.data:""},adOptions._set=function(a,b,c){var d={value:b,timeout:c};window.localStorage.setItem(a,JSON.stringify(d))};var p=window.location.pathname?window.location.pathname.toLowerCase():"";if(p.indexOf("webapp")>-1||window.localStorage.getItem("isInApp"))define(["cBase","cUIAbstractView","libs","cStore"],function(a,b){var c=new a.Class(b,adOptions);return c.getInstance=function(){return this.instance?this.instance:this.instance=new this},c});else{adOptions.show=function(){this.create(),this.status="",this.onShow()},adOptions.hide=function(){this.root.hide()},adOptions.trigger=function(){},adOptions.remove=function(){$("#dl_app").remove()};var config={rootBox:$("#footer")};adOptions.initialize(function(){},config);var AdView=adOptions;AdView.update(config),AdView.show()}