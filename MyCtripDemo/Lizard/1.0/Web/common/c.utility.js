define(["libs","cBase","cStorage","Validate"],function(a,b,c,d){var e={},f=(Array.prototype.slice,Array.prototype.push,function(a){return Object.prototype.toString.call(a)}),g=(b.Date,c.localStorage);return e.JsonArrayToObject=function(a){if(!a)return[];for(var b,c=a.shift(),d=[],g=0,h=a.length;h>g;g++){b={};for(var i=0,j=a[g].length;j>i;i++)switch(f(a[g][i])){case"[object Array]":b[c[i]]=e.JsonArrayToObject(a[g][i]);break;default:b[c[i]]=a[g][i]}d.push(b)}return d},e.mix=function(a,b,c){a=a||{},b=b||{};for(var d in b)b.hasOwnProperty(d)&&(c?null!==b[d]&&(a[d]=b[d]):a[d]=b[d]);return a},e.indexOf=function(a,b){var c,d=-1;for(c=0;c<b.length;c++)if(b[c]===a){d=c;break}return d},e.each=function(a,b,c){a=a||{},b=b||function(){};var d,e=Object.prototype.toString.call(a);if("[object Array]"===e)for(d=0;d<a.length;d++)b.call(c||a[d],d,a[d]);else if("[object Object]"===e)for(d in a)a.hasOwnProperty(d)&&b.call(c||a[d],d,a[d])},e.grep=function(a,b,c){var d;a=a||{},b=b||function(){};var e,f=Object.prototype.toString.call(a);if("[object Array]"===f)for(d=[],e=0;e<a.length;e++)b(a[e],e)&&d.push(a[e]);else if("[object Object]"===f){d=c?[]:{};for(e in a)a.hasOwnProperty(e)&&b(a[e],e)&&(c?d.push(a[e]):d[e]=a[e])}return d},e.deleteValue=function(a,b){var c=e.indexOf(a,b);return c>-1?b.splice(c,1):null},e.getGuid=function(){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function b(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}var c=localStorage.GUID||"";return c||(c=b(),localStorage.GUID=c),c},e.trim=function(){return function(a){return a.replace(/(^[\s\u3000]*)|([\s\u3000]*$)/g,"")}},e.stripTags=function(a){return(a||"").replace(/<[^>]+>/g,"")},e.jsonToQuery=function(){var a=function(a,b){return a=null==a?"":a,a=e.trim(a.toString()),b?encodeURIComponent(a):a};return function(b,c){var d=[];if("object"==typeof b)for(var e in b)if(b[e]instanceof Array)for(var f=0,g=b[e].length;g>f;f++)d.push(e+"="+a(b[e][f],c));else"function"!=typeof b[e]&&d.push(e+"="+a(b[e],c));return d.length?d.join("&"):""}}(),e.queryToJson=function(){function a(a){return"[object Array]"===Object.prototype.toString.call(a)}return function(b,c){for(var d=e.trim(b).split("&"),f={},g=function(a){return c?decodeURIComponent(a):a},h=0,i=d.length;i>h;h++)d[h]&&(_hsh=d[h].split("="),_key=_hsh[0],_value=_hsh[1],_hsh.length<2&&(_value=_key,_key="$nullName"),f[_key]?(1!=a(f[_key])&&(f[_key]=[f[_key]]),f[_key].push(g(_value))):f[_key]=g(_value));return f}}(),e.validate=function(){var a=function(){};$.each("String Function Boolean RegExp Number Date Object Null Undefined".split(" "),function(b,c){var d;switch(c){case"Null":d=function(a){return null===a};break;case"Undefined":d=function(a){return void 0===a};break;default:d=function(a){return new RegExp(c+"]","i").test(f(a))}}a["is"+c]=d});var b={Email:/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/,Qq:/^[1-9]\d{4,}$/,Phone:/^[0-9]{3,4}-[0-9]{7,8}$/,Url:/^http(s)?:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\:+!]*([^<>])*$/,Mobile:/^1\d{10}/,Postcode:/^\d{6}$/,IP:function(b){if(!b||a.isNull(b))return!1;var c=/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/g;return c.test(b)&&RegExp.$1<256&&RegExp.$2<256&&RegExp.$3<256&&RegExp.$4<256?!0:!1},EmptyObject:function(a){for(var b in a)return!1;return!0},IdCard:d.isIdCard,CharsLenWithinRange:function(b,c){if(!a.isString(b))return!1;var d=b.match(/\W/g),e=null==d?b.length:b.length+d.length;return(isValidate=e>=0&&c>=e)?(this.cutLen=b.length,!0):!1},ContactName:function(c){return a.isString(c)?b.CharsLenWithinRange.call(this,c,26):!1},BookPS:function(c){return a.isString(c)?b.CharsLenWithinRange.call(this,c,100):!1},InvTitle:function(c){return a.isString(c)?b.CharsLenWithinRange.call(this,c,100):!1},BoardTitle:function(c){return a.isString(c)?b.CharsLenWithinRange.call(this,c,40):!1},AreaTitle:function(c){return a.isString(c)?b.CharsLenWithinRange.call(this,c,80):!1},MobileNumber:function(b){if(!a.isString(b))return!1;var c=11;return b.length==c&&/^(\d| )+$/g.test(b)},FlightNumber:function(b){if(!a.isString(b))return!1;var c=3,d=7;return b.length>=c&&b.length<=d&&/^(\d|\w)+$/g.test(b)}};return $.each(b,function(b,c){a["is"+b]=function(b){return!b||a.isNull(b)||a.isNull(c)?!1:a.isFunction(c)?c.call(this,b):a.isRegExp(c)?c.test(b):!1}}),a}(),e.cookie=function(){var a={};return a.getCookie=function(a){a=a.replace(/([\.\[\]\$])/g,"\\$1");var b=new RegExp(a+"=([^;]*)?;","i"),c=document.cookie+";",d=c.match(b);return d?unescape(d[1])||"":""},a.setCookie=function(a,b,c,d,e,f){var g=[];if(g.push(a+"="+escape(b)),c){var h=new Date,i=h.getTime()+36e5*c;h.setTime(i),g.push("expires="+h.toGMTString())}d&&g.push("path="+d),e&&g.push("domain="+e),f&&g.push(f),document.cookie=g.join(";")},a.deleteCookie=function(a){document.cookie=a+"=;expires=Fri, 31 Dec 1999 23:59:59 GMT;"},a}(),e.dateParse=function(a){var b=new RegExp("^\\d+(\\-|\\/)\\d+(\\-|\\/)\\d+$");if("string"==typeof a){if(b.test(a)||isNaN(Date.parse(a))){var c=a.split(/ |T/),d=c.length>1?c[1].split(/[^\d]/):[0,0,0],e=c[0].split(/[^\d]/);return new Date(e[0]-0,e[1]-1,e[2]-0,d[0]-0,d[1]-0,d[2]-0)}return new Date(a)}return new Date},e.getServerTime=function(){var a=e.cookie.getCookie("WAP_SERVERDATE");return e.dateParse(a)},e.getServerDate=function(a){return b.getServerDate(a)},e.isInApp=function(){var a=window.navigator.userAgent;if(a.indexOf("CtripWireless")>-1)return!0;var b=g.oldGet("isInApp");if(b)return"1"==b?!0:!1;var c=g.oldGet("ISINAPP");return c?"1"==c?!0:!1:void 0},e.isInWeichat=function(){var a=window.navigator.userAgent;return a.indexOf("MicroMessenger")>-1?!0:!1},e.isPreProduction=function(){var a=g.oldGet("isPreProduction");return a},e.Object={set:function(a,b,c){if(!b)return null;var d=b.split(".");a=a||{},tmp=a;for(var e=0,f=d.length,g=Math.max(f-1,0);f>e;e++)g>e?tmp=tmp[d[e]]=tmp[d[e]]||{}:tmp[d[e]]=c;return a},get:function(a,b){if(!a||!b)return null;var c=b.split(".");a=a||{},tmp=a;var d=0,e=c.length;for(Math.max(e-1,0);e>d;d++)if(tmp=tmp[c[d]],"null"==typeof tmp||"undefined"==typeof tmp)return null;return tmp}},e.SimpleQueue=new b.Class({initialize:function(){this.index=0,this.handlers=[],this.isStart=!1},add:function(a){this.handlers.push(a),this.isStart||(this.isStart=!0,this._next())},_next:function(a){var b=this.handlers.shift();b&&b.call(this,this,a)},next:function(){this._next.apply(this,arguments),this.stop()},stop:function(){this.isStart=!1}}),e.tryUrl=function(a){var b=document.createElement("iframe");b.height=1,b.width=1,b.frameBorder=0,b.style.position="absolute",b.style.left="-9999px",b.style.top="-9999px",document.body.appendChild(b),e.tryUrl=function(a){b.src=a},e.tryUrl(a)},e});